[
  {
    "conditions": {
      "target.mappable.terrain": { "or": [ { "is": "grassland" }, { "is": "dirt" } ] },
      "not": { "other": { "habitable": "exists" } }
    },
    "event": {
      "key": "plough_field",
      "rules": {
        "target": [
          { "event": { "mappable": { "set": { "terrain": "ploughed" } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "not": { "other": { "habitable": "exists" } },
      "target.mappable.terrain": { "is": "grassland" },
      "season": {
        "or": [ { "is": "summer" } , { "is": "autumn" } ]
      }
    },
    "event": {
      "key": "gather_grain",
      "rules": {
        "me": [
          { "event": { "supplies": { "gain": { "grain": 1 } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.mappable.terrain": { "is": "harvestable" }
    },
    "event": {
      "key": "harvest_field",
      "rules": {
        "me": [
          { "event": { "supplies": { "gain": { "grain": 5 } } } }
        ],
        "target": [
          { "event": { "mappable": { "set": { "terrain": "dirt" } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.mappable.terrain": {
        "is": "ploughed"
      },
      "me.supplies.grain": { "greater": 0 },
      "season": {
        "or": [ { "is": "spring" } , { "is": "summer" } ]
      }
    },
    "event": {
      "key": "sow_field",
      "rules": {
        "me": [
          { "event": { "supplies": { "lose": { "grain": 1 } } } }
        ],
        "target": [
          { "event": { "mappable": { "set": { "terrain": "sown" } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.habitable": "exists",
      "target.habitable.owners": { "includes": "$me.id" },
      "me.attributes.energy": { "less": 3 }
    },
    "event": {
      "key": "recover",
      "rules": {
        "me": [
          {
            "event": { "attributes": { "gain": { "energy": 1 } } }
          }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.habitable": "exists",
      "target.habitable.owners": { "includes": "$me.id" },
      "me.attributes.energy": { "greaterEq": 3, "less": 10 }
    },
    "event": {
      "key": "rest",
      "rules": {
        "me": [
          { "event": { "attributes": { "gain": { "energy": 1 } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.habitable": "exists",
      "target.habitable.owners": { "includes": "$me.id" },
      "me.supplies.grain": { "greater": 0 },
      "me.attributes.energy": { "greater": 0, "less": 10 }
    },
    "event": {
      "key": "prepare_gruel",
      "rules": {
        "me": [
          { "event": { "attributes": { "gain": { "energy": 5 } } } },
          { "event": { "supplies": { "lose": { "grain": 1 } } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.mappable.terrain": { "is": "forest" }
    },
    "event": {
      "key": "chop_trees",
      "rules": {
        "me": [
          { "event": { "supplies": { "gain": { "wood": 1 } } } }
        ],
        "target": [
          {
            "conditions": {
              "traits.values": {
                "not": {
                  "or": [
                    { "includes": "thinned" },
                    { "includes": "deforested" },
                    { "includes":  "decimated" }
                  ]
                }
              }
            },
            "event": { "traits.values": { "add": "thinned" } }
          },
          {
            "conditions": {
              "traits.values": {
                "includes": "thinned"
              }
            },
            "event": { "traits.values": { "remove": "thinned", "add": "deforested" } }
          },
          {
            "conditions": {
              "traits.values": {
                "includes": "deforested"
              }
            },
            "event": { "traits.values": { "remove": "deforested", "add": "decimated" } }
          },
          {
            "conditions": {
              "traits.values": {
                "includes": "deforested"
              }
            },
            "event": { "mappable": { "set": { "terrain": "dirt" } } }
          }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.mappable.terrain": { "is": "forest" },
      "not": { "target.traits.values": { "includes": "planted" } }
    },
    "event": {
      "key": "plant_trees",
      "rules": {
        "target": [
          { "event": { "traits.values": { "add": "planted" } } }
        ]
      }
    }
  },
  {
    "conditions": {
      "target.mappable.terrain": { "is": "shallow water" },
      "me.traits.values": { "includes": "boat" }
    },
    "event": {
      "key": "fish",
      "rules": {
        "target": [
          { "event": { "traits.values": { "add": "fished" } } }
        ]
      }
    }
  }
]